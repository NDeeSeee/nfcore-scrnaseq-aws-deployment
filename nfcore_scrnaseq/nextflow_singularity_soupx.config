/*
 * nf-core/scrnaseq Local Singularity Configuration
 * soupX variant (skip CellBender, no GPU needed)
 */

params {
    // Input/Output
    input = 'samplesheet.csv'
    outdir = 'results_nfcore_soupx'

    // Reference files (same as Cell Ranger)
    fasta = '/data/salomonis-archive/genomes/spaceranger_ref/refdata-gex-GRCh38-2020-A/fasta/genome.fa'
    gtf = '/data/salomonis-archive/genomes/spaceranger_ref/refdata-gex-GRCh38-2020-A/genes/genes.gtf'
    txp2gene = '/data/salomonis-archive/FASTQs/NCI-R01/alevin_fry/splici_ref/splici_fl86_t2g_3col.tsv'

    // Aligner settings
    aligner = 'alevin'
    protocol = '10XV3'
    simpleaf_rlen = 91

    // SKIP CellBender (will add soupX post-processing)
    skip_emptydrops = true

    // Save reference for reuse
    save_reference = true

    // Resource limits
    max_cpus = 16
    max_memory = '64.GB'
    max_time = '12.h'
}

// Singularity configuration
singularity {
    enabled = true
    autoMounts = true
    cacheDir = './singularity_cache'  // Default temp location
}

// Process resource allocation
process {
    // Default resources
    cpus = 4
    memory = '16.GB'
    time = '4.h'

    // CPU-intensive processes
    withLabel: 'process_high' {
        cpus = 16
        memory = '64.GB'
        time = '6.h'
    }

    withLabel: 'process_medium' {
        cpus = 8
        memory = '48.GB'
        time = '4.h'
    }

    withLabel: 'process_low' {
        cpus = 2
        memory = '16.GB'
        time = '2.h'
    }

    // FastQC needs extra memory for large FASTQ files
    withName: 'FASTQC' {
        cpus = 8
        memory = '16.GB'
        time = '3.h'
    }

    // Specific processes
    withName: 'SIMPLEAF_INDEX' {
        cpus = 16
        memory = '48.GB'
        time = '3.h'
    }

    withName: 'SIMPLEAF_QUANT' {
        cpus = 16
        memory = '48.GB'
        time = '2.h'
    }
}

// Docker disabled, Singularity enabled
docker.enabled = false

// Disable Wave
wave.enabled = false
