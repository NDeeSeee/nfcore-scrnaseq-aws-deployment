/*
 * nf-core/scrnaseq Local Singularity Configuration
 * EmptyDrops filtering only (no CellBender, no soupX)
 */

params {
    // Input/Output
    input = 'samplesheet.csv'
    outdir = 'results_nfcore_emptydrops_only'

    // Reference files
    fasta = '/data/salomonis-archive/genomes/spaceranger_ref/refdata-gex-GRCh38-2020-A/fasta/genome.fa'
    gtf = '/data/salomonis-archive/genomes/spaceranger_ref/refdata-gex-GRCh38-2020-A/genes/genes.gtf'
    txp2gene = '/data/salomonis-archive/FASTQs/NCI-R01/alevin_fry/splici_ref/splici_fl86_t2g_3col.tsv'

    // Aligner settings
    aligner = 'alevin'
    protocol = '10XV3'
    simpleaf_rlen = 91

    // Enable EmptyDrops, skip CellBender
    skip_emptydrops = false
    skip_cellbender = true

    // Save reference for reuse
    save_reference = true

    // Resource limits
    max_cpus = 8
    max_memory = '64.GB'
    max_time = '12.h'
}

// Singularity configuration
singularity {
    enabled = true
    autoMounts = true
    cacheDir = './singularity_cache'
}

// Process resource allocation
process {
    // Default resources
    cpus = 4
    memory = '16.GB'
    time = '4.h'

    // CPU-intensive processes
    withLabel: 'process_high' {
        cpus = 8
        memory = '48.GB'
        time = '6.h'
    }

    withLabel: 'process_medium' {
        cpus = 4
        memory = '24.GB'
        time = '4.h'
    }

    withLabel: 'process_low' {
        cpus = 2
        memory = '8.GB'
        time = '2.h'
    }

    // FastQC
    withName: 'FASTQC' {
        cpus = 4
        memory = '16.GB'
        time = '3.h'
    }

    // Simpleaf
    withName: 'SIMPLEAF_INDEX' {
        cpus = 8
        memory = '32.GB'
        time = '3.h'
    }

    withName: 'SIMPLEAF_QUANT' {
        cpus = 8
        memory = '32.GB'
        time = '2.h'
    }

    // EmptyDrops (lightweight, R-based)
    withName: 'EMPTYDROPS_REMOVAL' {
        cpus = 4
        memory = '16.GB'
        time = '2.h'
    }
}

// Docker disabled, Singularity enabled
docker.enabled = false

// Disable Wave
wave.enabled = false
