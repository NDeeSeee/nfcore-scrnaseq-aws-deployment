/*
 * nf-core/scrnaseq local configuration
 * Using our validated GRCh38-2020-A reference (same as Cell Ranger)
 */

params {
    // Input/Output
    input = 'samplesheet.csv'
    outdir = 'results'

    // Reference files (same as Cell Ranger uses)
    fasta = '/data/salomonis-archive/genomes/spaceranger_ref/refdata-gex-GRCh38-2020-A/fasta/genome.fa'
    gtf = '/data/salomonis-archive/genomes/spaceranger_ref/refdata-gex-GRCh38-2020-A/genes/genes.gtf'

    // Use our pre-built transcript-to-gene mapping
    txp2gene = '/data/salomonis-archive/FASTQs/NCI-R01/alevin_fry/splici_ref/splici_fl86_t2g_3col.tsv'

    // Aligner settings
    aligner = 'alevin'
    protocol = '10XV3'
    simpleaf_rlen = 91

    // Save the index for reuse
    save_reference = true

    // Skip cellbender (we'll use EmptyDrops separately if needed)
    skip_emptydrops = true

    // Max resources for local execution
    max_cpus = 16
    max_memory = '64.GB'
    max_time = '12.h'
}

// Use singularity for containerization
singularity {
    enabled = true
    autoMounts = true
    cacheDir = '/data/salomonis-archive/FASTQs/NCI-R01/alevin_fry/nfcore_scrnaseq/singularity_cache'
}

// Process-specific resource allocation
process {
    withName: 'SIMPLEAF_INDEX' {
        cpus = 16
        memory = '32.GB'
        time = '2.h'
    }
    withName: 'SIMPLEAF_QUANT' {
        cpus = 16
        memory = '32.GB'
        time = '2.h'
    }
}
